version: 2

models:
  - name: fact_sales
    description: "Fato de vendas na granularidade de item de pedido."
    columns:
      - name: sales_item_id
        description: "Chave primária do fato."
        tests:
          - not_null


      - name: order_date
        description: "Data do pedido, compatível com a chave da dimensão de datas."
        tests:
          - not_null
          - relationships:
              to: ref('dim_date')
              field: date_id
              severity: error

      - name: sk_cliente
        description: "Identificador do cliente."
        tests:
          - not_null
          - relationships:
              to: ref('dim_customers')
              field: customer_id

      - name: product_id
        description: "Identificador do produto."
        tests:
          - not_null
          - relationships:
              to: ref('dim_products')
              field: product_id

      - name: order_qty
        description: "Quantidade de itens comprados no pedido."
        tests:
          - dbt_utils.expression_is_true:
              expression: ">= 0"

      - name: unit_price
        description: "Preço unitário do produto."
        tests:
          - dbt_utils.expression_is_true:
              expression: ">= 0"

      - name: unit_precied_discount
        description: "Desconto unitário aplicado."
        tests:
          - dbt_utils.expression_is_true:
              expression: ">= 0"

      - name: gross_revenue
        description: "Faturamento bruto do item."
        tests:
          - dbt_utils.expression_is_true:
              expression: ">= 0"

      - name: discount_amount
        description: "Valor total de desconto aplicado ao item."
        tests:
          - dbt_utils.expression_is_true:
              expression: ">= 0"

      - name: net_revenue
        description: "Receita líquida do item."
        tests:
          - dbt_utils.expression_is_true:
              expression: ">= 0"
